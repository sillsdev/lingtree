# This workflow will build a Java project with Ant
# For more information see: https://docs.github.com/en/actions/automating-builds-and-tests/building-and-testing-java-with-ant

name: Manual Compile and Build Installer

on:
  push:
  workflow_dispatch:

jobs:
  build:

    runs-on: windows-latest

    steps:
    - uses: actions/checkout@v4
    - name: Set up JDK 17
      uses: actions/setup-java@v4
      with:
        java-version: '17'
        distribution: 'zulu'
        java-package: 'jdk+fx'
    - name: Build with Ant
      run: |
        pwd
        ant -noinput -buildfile build.xml
        pwd
        ls -l
      shell: bash

  build_installer:
    name: Build Windows Installer
    needs: build
    runs-on: windows-latest
    steps:
    - uses: actions/checkout@v4
    - name: Set up JDK 17
      uses: actions/setup-java@v4
      with:
        java-version: '17'
        distribution: 'zulu'
        java-package: 'jdk+fx'
    - name: Look for bin directory created by ant
      run: |
        pwd
        ls -l
        ls -l bin
      shell: bash
    - name: Run the Windows installer batch file
      run: |
          cd installer/windows
          BuildWin.bat
      shell: cmd
